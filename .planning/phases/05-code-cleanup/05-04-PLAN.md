---
phase: 05-code-cleanup
plan: 04
type: execute
wave: 3
depends_on: ["05-01", "05-02", "05-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Plugin activates on staging without PHP fatal errors"
    - "Designation sync works: publish fund creates designation"
    - "Designation sync works: trash fund deactivates designation"
    - "Inbound sync polling runs without errors"
    - "Admin UI displays designation info correctly"
    - "No orphaned campaign code remains in deployed plugin files"
  artifacts: []
  key_links: []
---

<objective>
Deploy to staging and verify designation sync still works

Purpose: Confirm code cleanup did not break designation sync functionality
Output: Verified working plugin on WP Engine staging
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@CLAUDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Deploy to WP Engine staging</name>
  <files></files>
  <action>
Deploy the updated plugin to WP Engine staging using rsync:

```bash
rsync -avz --exclude='.git' --exclude='.planning' --exclude='*.zip' \
  /Users/chadmacbook/projects/fcg/ \
  frederickc2stg@frederickc2stg.ssh.wpengine.net:~/sites/frederickc2stg/wp-content/plugins/fcg-gofundme-sync/
```

After deployment, verify plugin loads without errors:

```bash
ssh frederickc2stg@frederickc2stg.ssh.wpengine.net "cd ~/sites/frederickc2stg && wp plugin list | grep fcg"
```

Expected output should show plugin active with version 2.3.0.
  </action>
  <verify>
SSH command shows plugin is active and version 2.3.0
No PHP fatal errors in WP Engine error logs
  </verify>
  <done>
- Plugin deployed to staging via rsync
- Plugin shows as active in WP-CLI output
- Version 2.3.0 confirmed
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify designation sync on staging</name>
  <files></files>
  <action>
Test designation sync via WP-CLI on staging:

**Test 1: Check existing designation sync status**
```bash
ssh frederickc2stg@frederickc2stg.ssh.wpengine.net "cd ~/sites/frederickc2stg && wp fcg-sync status | head -20"
```

**Test 2: Run inbound sync poll**
```bash
ssh frederickc2stg@frederickc2stg.ssh.wpengine.net "cd ~/sites/frederickc2stg && wp fcg-sync pull --dry-run"
```

Expected: Should complete without errors, showing designation sync status.

**Test 3: Check PHP error log for any errors**
```bash
ssh frederickc2stg@frederickc2stg.ssh.wpengine.net "grep -i 'fcg gofundme' ~/sites/frederickc2stg/wp-content/debug.log 2>/dev/null | tail -20"
```

Expected: No new errors related to undefined methods or missing campaign functions.

**Test 4: Verify no orphaned campaign code remains in plugin files**
```bash
ssh frederickc2stg@frederickc2stg.ssh.wpengine.net "cd ~/sites/frederickc2stg/wp-content/plugins/fcg-gofundme-sync && grep -rn 'duplicate_campaign\|publish_campaign\|unpublish_campaign\|reactivate_campaign\|deactivate_campaign\|sync_campaign_to_gofundme\|META_CAMPAIGN_ID\|META_CAMPAIGN_URL' --include='*.php' . 2>/dev/null || echo 'No orphaned campaign code found'"
```

Expected: "No orphaned campaign code found" â€” all campaign lifecycle methods should be removed.
  </action>
  <verify>
WP-CLI commands complete without fatal errors
No "undefined method" or "call to undefined function" errors in logs
Designation sync status shows linked designations
  </verify>
  <done>
- WP-CLI fcg-sync status runs successfully
- WP-CLI fcg-sync pull --dry-run completes
- No PHP errors in debug log related to removed methods
- Grep confirms no orphaned campaign code in deployed plugin
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Cleaned up plugin deployed to staging with campaign code removed</what-built>
  <how-to-verify>
**Manual verification steps:**

1. **Plugin activation check:**
   - Go to https://frederickc2stg.wpengine.com/wp-admin/plugins.php
   - Verify "FCG GoFundMe Pro Sync" shows version 2.3.0
   - Verify no PHP errors displayed

2. **Admin UI check:**
   - Go to Funds > All Funds
   - Click edit on any fund with a designation ID
   - In the "GoFundMe Pro Sync" meta box:
     - Verify "Designation ID" is displayed (not "Campaign ID")
     - Verify "Last Sync" timestamp is shown
     - Verify "Sync Now" button works

3. **Designation sync test (optional - only if comfortable):**
   - Create a new test fund with title "Test Cleanup Phase"
   - Publish the fund
   - Check that designation ID appears in meta box
   - Trash the fund
   - Delete permanently or restore

4. **Settings page check:**
   - Go to Funds > Sync Settings
   - Verify page loads without errors
   - Verify "API Status: Connected" shows
  </how-to-verify>
  <resume-signal>Type "verified" if all checks pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. Plugin deploys and activates on staging
2. WP-CLI sync commands work
3. Manual verification confirms designation sync functional
4. No PHP errors in logs
</verification>

<success_criteria>
- Plugin version 2.3.0 active on staging
- Designation sync creates/updates/deactivates designations correctly
- No references to removed campaign methods in error logs
- Admin UI displays designation info (not campaign info)
</success_criteria>

<output>
After completion, create `.planning/phases/05-code-cleanup/05-04-SUMMARY.md`
</output>
